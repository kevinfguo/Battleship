var gameLogic;!function(a){function b(){return{gameBoard:[[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]],[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]],[["X","","","","","","","","",""],["X","","","","","","","X","X","X"],["X","","","","","","","","",""],["X","","","","","","","","",""],["X","","","","","","","","",""],["","","X","X","X","","","","",""],["","X","","","","","","","",""],["","X","","","","","","","",""],["","X","","","","","","","X",""],["","X","","","","","","","X",""]],[["","","","","","X","","","",""],["X","","","","","X","","","",""],["X","","","","","X","","","",""],["X","","","","","","","","",""],["X","","","","","","","","",""],["X","","","","","","","","",""],["","","","","","X","X","X","",""],["","","","","","","","","",""],["X","X","X","X","","","","","",""],["","","","","","","","","X","X"]]],phase:2}}function c(a){for(var b=!0,c=!0,d=0;10>d;d++)for(var e=0;10>e;e++){var f=a.gameBoard[3][d][e],g=a.gameBoard[0][d][e];"X"==f&&"O"!=g&&(b=!1)}for(var d=0;10>d;d++)for(var e=0;10>e;e++){var f=a.gameBoard[2][d][e],g=a.gameBoard[1][d][e];"X"==f&&"O"!=g&&(c=!1)}return b?"P1":c?"P2":""}function d(a,d,e,f){if(a||(a=b()),1===a.phase){var g=angular.copy(a);g.gameBoard[3-f][d][e]="X";var h={setTurn:{turnIndex:1-f}},i={row:d,col:e};return[h,{set:{key:"board",value:g}},{set:{key:"delta",value:i}}]}if(""!==a.gameBoard[f][d][e])throw new Error("One can only make a move in an empty position!");if(""!==c(a,f))throw new Error("Can only make a move if the game is not over!");var g=angular.copy(a);g.gameBoard[f][d][e]="X"===g.gameBoard[3-f][d][e]?"O":"X";var h,j=c(g,f);h=""!==j?{endMatch:{endMatchScores:"P1"===j?[1,0]:[0,1]}}:{setTurn:{turnIndex:1-f}};var i={row:d,col:e};return[h,{set:{key:"board",value:g}},{set:{key:"delta",value:i}}]}function e(a){var b=a.move,c=a.turnIndexBeforeMove,e=a.stateBeforeMove;try{var f=b[2].set.value,g=f.row,h=f.col,i=e.board,j=d(i,g,h,c);if(!angular.equals(b,j))return!1}catch(k){return!1}return!0}a.ROWS=10,a.COLS=10,a.getInitialBoard=b,a.createMove=d,a.isMoveOk=e}(gameLogic||(gameLogic={}));var game;!function(a){function b(){console.log("Translation of 'RULES_OF_BATTLESHIP' is "+translate("RULES_OF_BATTLESHIP")),resizeGameAreaService.setWidthToHeight(1),gameService.setGame({minNumberOfPlayers:2,maxNumberOfPlayers:2,isMoveOk:gameLogic.isMoveOk,updateUI:h}),document.addEventListener("animationend",f,!1),document.addEventListener("webkitAnimationEnd",f,!1),document.addEventListener("oanimationend",f,!1),dragAndDropService.addDragListener("boardArea",c)}function c(a,b,c){t=document.getElementById("boardArea"),u=document.getElementById("gameArea"),v=document.getElementById("draggingLines"),w=document.getElementById("verticalDraggingLine"),x=document.getElementById("horizontalDraggingLine"),y=null;var e=b-u.offsetLeft,f=c-Math.floor(t.offsetTop+.05*t.offsetTop);if(0>e||0>f||e>=t.clientWidth||f>=t.clientHeight)return void(v.style.display="none");v.style.display="inline";var g=Math.floor(A*e/t.clientWidth),h=Math.floor(z*f/t.clientHeight),j=d(h,g);if(w.setAttribute("x1",String(j.x)),w.setAttribute("x2",String(j.x)),x.setAttribute("y1",String(j.y)),x.setAttribute("y2",String(j.y)),"touchend"===a||"touchcancel"===a||"touchleave"===a||"mouseup"===a){v.style.display="none";var k=0;g>9&&(g-=10,k=1),log.info("Targeted row: "+h+" and column: "+g),i(h,g,k)}}function d(a,b){var c=e();return{x:b*c.width+c.width/2,y:a*c.height+c.height/2}}function e(){return{width:t.clientWidth/A,height:t.clientHeight/z}}function f(){$rootScope.$apply(function(){log.info("Animation ended"),o=!0,q&&g()})}function g(){gameService.makeMove(aiService.findComputerMove(r))}function h(a){log.info("Game got updateUI:",a),o=!1,r=a,s=a.stateAfterMove,s.board||(s.board=gameLogic.getInitialBoard()),p=a.turnIndexAfterMove>=0&&a.yourPlayerIndex===a.turnIndexAfterMove,q=p&&""===a.playersInfo[a.yourPlayerIndex].playerId,q&&(p=!1,s.delta||g())}function i(a,b,c){if(log.info("Clicked on board:",c,"Clicked on cell:",a,b),"?throwException"===window.location.search)throw new Error("Throwing the error because URL has '?throwException'");if(p&&r.turnIndexAfterMove==1-c)try{var d=gameLogic.createMove(s.board,a,b,r.turnIndexAfterMove);p=!1,gameService.makeMove(d)}catch(e){return void log.info(["Cell is already full in position:",a,b])}}function j(a,b,c){var d=s.board.gameBoard[1-c][a][b];return""!==d}function k(a,b,c){return"X"===s.board.gameBoard[1-c][a][b]}function l(a,b,c){return"O"===s.board.gameBoard[1-c][a][b]}function m(a,b){return!o&&s.delta&&s.delta.row===a&&s.delta.col===b}function n(a,b,c){return r.turnIndexBeforeMove!=1-c||q?!1:"X"===s.board.gameBoard[2+c][a][b]}var o=!1,p=!1,q=!1,r=null,s=null;a.isHelpModalShown=!1;var t,u,v,w,x,y,z=10,A=20;a.init=b,a.handleDragEvent=c,a.cellClicked=i,a.shouldShowImage=j,a.isPieceX=k,a.isPieceO=l,a.shouldSlowlyAppear=m,a.isBattleship=n}(game||(game={})),angular.module("myApp",["ngTouch","ui.bootstrap","gameServices"]).run(function(){$rootScope.game=game,translate.setLanguage("en",{RULES_OF_BATTLESHIP:"Rules of Battleship",RULES_SLIDE1:"First, you and your opponent place your 5 battleships on your own board.",RULES_SLIDE2:"You and your opponent then take turns to fire upon the enemy board. If you hit an enemy battleship, you will score a X. If you miss, you will score a O.",RULES_SLIDE3:"The first player to eliminate all opposing battleships is declared the winner.",CLOSE:"Close"}),game.init()});var aiService;!function(a){function b(a){return g(a.stateAfterMove.board,a.turnIndexAfterMove,{millisecondsLimit:1e3})}function c(a,b){for(var c=[],d=0;d<gameLogic.ROWS;d++)for(var e=0;e<gameLogic.COLS;e++)try{c.push(gameLogic.createMove(a,d,e,b))}catch(f){}return c}function d(a,b){for(var c=[],d=[],f=0,g=0;g<a.length;g++)c[g]=e(a[g],b),c[g]==f?d.push(a[g]):c[g]>f&&(d=[],d.push(a[g]));var h=Math.floor(Math.random()*d.length);return d[h]}function e(a,b){var c=0,d=a[1].set.value,e=a[2].set.value,g=e.row,h=e.col;return c+=f(d,g+1,h,b),c+=f(d,g-1,h,b),c+=f(d,g,h+1,b),c+=f(d,g,h-1,b)}function f(a,b,c,d){return b>9||c>9||0>b||0>c?0:"O"===a.gameBoard[d][b][c]?1:0}function g(a,b){return h(c(a,b))}function h(a){var b,c=Math.floor(Math.random()*a.length);return b=a[c]}a.findComputerMove=b,a.getPossibleMoves=c,a.scoreMoves=d,a.getScoredMove=e,a.createComputerMove=g,a.randomGuess=h}(aiService||(aiService={}));
//# sourceMappingURL=everything.min.js.map